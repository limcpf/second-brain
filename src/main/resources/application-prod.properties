# 프로덕션 설정 (NixOS)
quarkus.profile=prod
quarkus.log.console.json=true

# RabbitMQ
mp.messaging.incoming.brain-requests.connector=smallrye-rabbitmq
mp.messaging.incoming.brain-requests.exchange.name=bot.exchange
mp.messaging.incoming.brain-requests.queue.name=brain.inbox.q
mp.messaging.incoming.brain-requests.routing-key=brain.req.#
mp.messaging.outgoing.brain-replies.connector=smallrye-rabbitmq
mp.messaging.outgoing.brain-replies.exchange.name=brain.reply.exchange

rabbitmq-host=${RABBITMQ_HOST}
rabbitmq-port=5672
rabbitmq-username=${RABBITMQ_USER}
rabbitmq-password=${RABBITMQ_PASS}

# OpenAI
OPENAI_API_KEY=${OPENAI_API_KEY}
openai.model=gpt-5-mini
openai.temperature=0.2

app.openai.api-key=${OPENAI_API_KEY}
app.openai.model=${openai.model}
app.openai.temperature=${openai.temperature}

# Obsidian vault
VAULT_PATH=/app/data/vault
TEMPLATE_PATH=/app/resources/templates

app.paths.vault-path=${VAULT_PATH}
app.paths.template-path=${TEMPLATE_PATH}

# Google credentials
GOOGLE_CREDENTIAL_PATH=/app/config/tokens
app.google.credential-path=${GOOGLE_CREDENTIAL_PATH}

# Docker
DOCKER_HOST=unix:///var/run/docker.sock
SYNC_IMAGE=lscr.io/linuxserver/obsidian:latest
SYNC_WAIT_SECONDS=30
OBSIDIAN_CONFIG_PATH=/app/data/obsidian-config
OBSIDIAN_PUID=1000
OBSIDIAN_PGID=1000
OBSIDIAN_TZ=Asia/Seoul

app.docker.host=${DOCKER_HOST}
app.docker.image=${SYNC_IMAGE}
app.docker.sync-wait-seconds=${SYNC_WAIT_SECONDS}
app.docker.config-path=${OBSIDIAN_CONFIG_PATH}
app.docker.puid=${OBSIDIAN_PUID}
app.docker.pgid=${OBSIDIAN_PGID}
app.docker.timezone=${OBSIDIAN_TZ}

# Idempotency
app.idempotency.backend=sqlite
app.idempotency.path=/app/data/idempotency.log
app.idempotency.sqlite-path=/app/data/idempotency.db
app.idempotency.ttl-hours=24

# SQLite datasource (prod)
quarkus.datasource.db-kind=sqlite
quarkus.datasource.jdbc.url=jdbc:sqlite:${app.idempotency.sqlite-path}?journal_mode=WAL&synchronous=NORMAL
quarkus.datasource.jdbc.min-size=1
quarkus.datasource.jdbc.max-size=2

# DLQ
mp.messaging.incoming.brain-requests.failure-strategy=reject
mp.messaging.incoming.brain-requests.auto-bind-dlq=true
mp.messaging.incoming.brain-requests.dead-letter-queue-name=brain.inbox.dlq
mp.messaging.incoming.brain-requests.dead-letter-exchange=brain.dlx
mp.messaging.incoming.brain-requests.dead-letter-exchange-type=direct
mp.messaging.incoming.brain-requests.dead-letter-routing-key=brain.req.dlq

mp.messaging.incoming.brain-requests-dlq.connector=smallrye-rabbitmq
mp.messaging.incoming.brain-requests-dlq.queue.name=${mp.messaging.incoming.brain-requests.dead-letter-queue-name}
mp.messaging.incoming.brain-requests-dlq.exchange.name=${mp.messaging.incoming.brain-requests.dead-letter-exchange}
mp.messaging.incoming.brain-requests-dlq.routing-keys=${mp.messaging.incoming.brain-requests.dead-letter-routing-key}
mp.messaging.incoming.brain-requests-dlq.failure-strategy=accept
